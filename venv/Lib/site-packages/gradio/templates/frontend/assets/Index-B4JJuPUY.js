import"./svelte/svelte_internal_flags_async.js";import*as e from"./svelte/svelte_internal_client.js";import"./i18n-jwgpNIDD.js";import{G as le}from"./utils.svelte-Ceck75cM.js";import{e as Y,R as X,y as Z,B as ae}from"./IconButtonWrapper-CKkeBFM2.js";import"./svelte/svelte_internal_flags_legacy.js";import{createEventDispatcher as oe,tick as ie}from"./svelte/svelte_svelte.js";import{fly as ne}from"./svelte/svelte_transition.js";import{S as de}from"./StreamingBar-CiZ1eSYP.js";import{default as We}from"./Example-Ctdnw0MA.js";import"./svelte/svelte_store.js";import"./index-CGvp2os9.js";import"./svelte/svelte_animate.js";import"./svelte/svelte_attachments.js";import"./svelte/svelte_easing.js";import"./svelte/svelte_internal_flags_tracing.js";import"./svelte/svelte_internal_server.js";import"./svelte/svelte_legacy.js";import"./svelte/svelte_motion.js";import"./svelte/svelte_reactivity.js";import"./svelte/svelte_reactivity_window.js";import"./svelte/svelte_server.js";import"./svelte/svelte_events.js";import"./MarkdownCode-DE3cszAA.js";import"./prism-python-t00J-xmS.js";var ue=e.from_html('<li data-testid="dropdown-option" role="option"><span>âœ“</span> </li>'),pe=e.from_html('<ul class="options svelte-1ou0lab" role="listbox"></ul>'),ce=e.from_html('<div class="reference"></div> <!>',1);function ee(w,a){e.push(a,!1);let s=e.prop(a,"choices",12),t=e.prop(a,"filtered_indices",12),d=e.prop(a,"show_options",12,!1),A=e.prop(a,"disabled",12,!1),p=e.prop(a,"selected_indices",28,()=>[]),m=e.prop(a,"active_index",12,null),b=e.prop(a,"remember_scroll",12,!1),x=e.prop(a,"offset_from_top",12,0),D=e.prop(a,"from_top",12,!1),u=e.mutable_source(),c=e.mutable_source(),k=e.mutable_source(),T=e.mutable_source(),i=e.mutable_source(),g=e.mutable_source(),C=e.mutable_source(),R=e.mutable_source(),L=e.mutable_source(),N=e.mutable_source(),z=e.mutable_source(0);function S(){const{top:o,bottom:_}=e.get(i).getBoundingClientRect();D()?e.set(u,x()):e.set(u,o),e.set(c,e.get(N)-_)}let I=null;function U(){d()&&(I!==null&&clearTimeout(I),I=setTimeout(()=>{S(),I=null},10))}function M(){e.get(g)?.scrollTo?.(0,e.get(z))}const P=oe();e.legacy_pre_effect(()=>(e.deep_read_state(d()),e.get(i),e.deep_read_state(b()),e.get(g),e.deep_read_state(p()),e.get(k),e.get(c),e.get(u),e.deep_read_state(D())),()=>{if(d()&&e.get(i)){if(b())M();else if(e.get(g)&&p().length>0){let _=e.get(g).querySelectorAll("li");for(const l of Array.from(_))if(l.getAttribute("data-index")===p()[0].toString()){e.get(g)?.scrollTo?.(0,l.offsetTop);break}}S();const o=e.get(i).parentElement?.getBoundingClientRect();e.set(k,o?.height||0),e.set(T,o?.width||0)}e.get(c)>e.get(u)||D()?(e.set(C,`${e.get(u)}px`),e.set(L,e.get(c)),e.set(R,null)):(e.set(R,`${e.get(c)+e.get(k)}px`),e.set(L,e.get(u)-e.get(k)),e.set(C,null))}),e.legacy_pre_effect_reset();var q={get choices(){return s()},set choices(o){s(o),e.flush()},get filtered_indices(){return t()},set filtered_indices(o){t(o),e.flush()},get show_options(){return d()},set show_options(o){d(o),e.flush()},get disabled(){return A()},set disabled(o){A(o),e.flush()},get selected_indices(){return p()},set selected_indices(o){p(o),e.flush()},get active_index(){return m()},set active_index(o){m(o),e.flush()},get remember_scroll(){return b()},set remember_scroll(o){b(o),e.flush()},get offset_from_top(){return x()},set offset_from_top(o){x(o),e.flush()},get from_top(){return D()},set from_top(o){D(o),e.flush()}};e.init();var G=ce();e.event("scroll",e.window,U);var h=e.first_child(G);e.bind_this(h,o=>e.set(i,o),()=>e.get(i));var j=e.sibling(h,2);{var J=o=>{var _=pe();let l;e.each(_,5,t,e.index,(f,v)=>{var O=ue();let r,n;var y=e.child(O);let H;var K=e.sibling(y);e.reset(O),e.template_effect((Q,F,B)=>{r=e.set_class(O,1,"item svelte-1ou0lab",null,r,Q),e.set_attribute(O,"data-index",e.get(v)),e.set_attribute(O,"aria-label",(e.deep_read_state(s()),e.get(v),e.untrack(()=>s()[e.get(v)][0]))),e.set_attribute(O,"aria-selected",F),n=e.set_style(O,"",n,{width:e.get(T)+"px"}),H=e.set_class(y,1,"inner-item svelte-1ou0lab",null,H,B),e.set_text(K,` ${e.deep_read_state(s()),e.get(v),e.untrack(()=>s()[e.get(v)][0])??""}`)},[()=>({selected:p().includes(e.get(v)),active:e.get(v)===m(),"bg-gray-100":e.get(v)===m(),"dark:bg-gray-600":e.get(v)===m()}),()=>(e.deep_read_state(p()),e.get(v),e.untrack(()=>p().includes(e.get(v)))),()=>({hide:!p().includes(e.get(v))})]),e.append(f,O)}),e.reset(_),e.bind_this(_,f=>e.set(g,f),()=>e.get(g)),e.template_effect(()=>l=e.set_style(_,"",l,{top:e.get(C),bottom:e.get(R),"max-height":`calc(${e.get(L)}px - var(--window-padding))`,width:e.get(T)+"px"})),e.transition(3,_,()=>ne,()=>({duration:200,y:5})),e.event("mousedown",_,e.preventDefault(f=>P("change",f))),e.event("scroll",_,f=>e.set(z,f.currentTarget.scrollTop)),e.append(o,_)};e.if(j,o=>{d()&&!A()&&o(J)})}return e.bind_window_size("innerHeight",o=>e.set(N,o)),e.append(w,G),e.pop(q)}function _e(w,a){return(w%a+a)%a}function te(w,a){return w.reduce((s,t,d)=>((!a||t[0].toLowerCase().includes(a.toLowerCase()))&&s.push(d),s),[])}function se(w,a,s){if(w.key==="Escape")return[!1,a];if((w.key==="ArrowDown"||w.key==="ArrowUp")&&s.length>0)if(a===null)a=w.key==="ArrowDown"?s[0]:s[s.length-1];else{const t=s.indexOf(a),d=w.key==="ArrowUp"?-1:1;a=s[_e(t+d,s.length)]}return[!0,a]}var ve=e.from_html('<div class="token-remove svelte-1dv2vbb" role="button" tabindex="0"><!></div>'),fe=e.from_html('<div class="token svelte-1dv2vbb"><span class="svelte-1dv2vbb"><!></span> <!></div>'),ge=e.from_html('<div role="button" tabindex="0" class="token-remove remove-all svelte-1dv2vbb"><!></div>'),he=e.from_html('<!> <span class="icon-wrap svelte-1dv2vbb"><!></span>',1),me=e.from_html('<label><!> <div class="wrap svelte-1dv2vbb"><div><!> <div class="secondary-wrap svelte-1dv2vbb"><input autocomplete="off"/> <!></div></div> <!></div></label>');function be(w,a){e.push(a,!0),e.rest_props(a,["$$slots","$$events","$$legacy"]);const s=a.gradio;let t,d=e.state(""),A=e.derived(()=>s.shared.label||"Multiselect"),p=e.derived(()=>s.props.choices.map(r=>r[0])),m=e.derived(()=>s.props.choices.map(r=>r[1])),b=e.derived(()=>!s.shared.interactive),x=e.state(!1),D=e.derived(()=>{const r=te(s.props.choices,e.get(d));return[r,r.length>0&&!s.props.allow_custom_value?r[0]:null]}),u=e.derived(()=>e.to_array(e.get(D),2)),c=e.derived(()=>e.get(u)[0]),k=e.derived(()=>e.get(u)[1]);function T(){return s.props.value===void 0?[]:Array.isArray(s.props.value)?s.props.value.map(r=>{const n=e.get(m).indexOf(r);if(n!==-1)return n;if(s.props.allow_custom_value)return r}).filter(r=>r!==void 0):[]}let i=e.derived(T);function g(){s.props.allow_custom_value||e.set(d,""),s.props.allow_custom_value&&e.get(d)!==""&&(R(e.get(d)),e.set(d,"")),s.dispatch("blur"),e.set(x,!1),e.set(k,null)}function C(r){e.set(i,e.get(i).filter(n=>n!==r)),s.props.value=e.get(i).map(n=>typeof n=="number"?e.get(m)[n]:n),s.dispatch("input"),s.dispatch("select",{index:typeof r=="number"?r:-1,value:typeof r=="number"?e.get(m)[r]:r,selected:!1})}function R(r){(s.props.max_choices==null||e.get(i).length<s.props.max_choices)&&(e.get(i).push(r),s.dispatch("select",{index:typeof r=="number"?r:-1,value:typeof r=="number"?e.get(m)[r]:r,selected:!0})),e.get(i).length===s.props.max_choices&&(e.set(x,!1),e.set(k,null),t.blur()),s.props.value=e.get(i).map(n=>typeof n=="number"?e.get(m)[n]:n)}function L(r){const n=parseInt(r.detail.target.dataset.index);N(n)}function N(r){e.get(i).includes(r)?C(r):R(r),e.set(d,""),e.set(k,null),s.dispatch("input")}function z(r){e.set(i,[]),e.set(d,""),s.props.value=[],r.preventDefault()}function S(r){e.set(c,s.props.choices.map((n,y)=>y)),(s.props.max_choices===null||e.get(i).length<s.props.max_choices)&&e.set(x,!0),s.dispatch("focus"),e.set(x,!0)}function I(r){(n=>{var y=e.to_array(n,2);e.set(x,y[0],!0),e.set(k,y[1])})(se(r,e.get(k),e.get(c))),r.key==="Enter"&&(e.get(k)!==null?N(e.get(k)):s.props.allow_custom_value&&(R(e.get(d)),e.set(d,""))),r.key==="Backspace"&&e.get(d)===""&&e.set(i,[...e.get(i).slice(0,-1)]),e.get(i).length===s.props.max_choices&&(e.set(x,!1),e.set(k,null))}let U=e.state(e.proxy(s.props.value));e.user_effect(()=>{e.get(U)!==s.props.value&&(e.set(U,s.props.value,!0),s.dispatch("change"))});var M=me();let P;var q=e.child(M);Y(q,{get show_label(){return s.shared.show_label},get info(){return s.props.info},children:(r,n)=>{e.next();var y=e.text();e.template_effect(()=>e.set_text(y,e.get(A))),e.append(r,y)},$$slots:{default:!0}});var G=e.sibling(q,2),h=e.child(G);let j;var J=e.child(h);e.each(J,17,()=>e.get(i),e.index,(r,n)=>{var y=fe(),H=e.child(y),K=e.child(H);{var Q=$=>{var E=e.text();e.template_effect(()=>e.set_text(E,e.get(p)[e.get(n)])),e.append($,E)},F=$=>{var E=e.text();e.template_effect(()=>e.set_text(E,e.get(n))),e.append($,E)};e.if(K,$=>{typeof e.get(n)=="number"?$(Q):$(F,!1)})}e.reset(H);var B=e.sibling(H,2);{var V=$=>{var E=ve(),re=e.child(E);X(re),e.reset(E),e.template_effect(W=>e.set_attribute(E,"title",W),[()=>s.i18n("common.remove")+" "+e.get(n)]),e.event("click",E,e.preventDefault(()=>C(e.get(n)))),e.event("keydown",E,W=>{W.key==="Enter"&&C(e.get(n))}),e.append($,E)};e.if(B,$=>{e.get(b)||$(V)})}e.reset(y),e.append(r,y)});var o=e.sibling(J,2),_=e.child(o);e.remove_input_defaults(_);let l;e.bind_this(_,r=>t=r,()=>t);var f=e.sibling(_,2);{var v=r=>{var n=he(),y=e.first_child(n);{var H=F=>{var B=ge(),V=e.child(B);X(V),e.reset(B),e.template_effect($=>e.set_attribute(B,"title",$),[()=>s.i18n("common.clear")]),e.event("click",B,z),e.event("keydown",B,$=>{$.key==="Enter"&&z($)}),e.append(F,B)};e.if(y,F=>{e.get(i).length>0&&F(H)})}var K=e.sibling(y,2),Q=e.child(K);Z(Q),e.reset(K),e.append(r,n)};e.if(f,r=>{e.get(b)||r(v)})}e.reset(o),e.reset(h);var O=e.sibling(h,2);ee(O,{get show_options(){return e.get(x)},get choices(){return s.props.choices},get filtered_indices(){return e.get(c)},get disabled(){return e.get(b)},get selected_indices(){return e.get(i)},get active_index(){return e.get(k)},remember_scroll:!0,$$events:{change:L}}),e.reset(G),e.reset(M),e.template_effect(r=>{P=e.set_class(M,1,"svelte-1dv2vbb",null,P,{container:s.shared.container}),j=e.set_class(h,1,"wrap-inner svelte-1dv2vbb",null,j,{show_options:e.get(x)}),l=e.set_class(_,1,"border-none svelte-1dv2vbb",null,l,r),_.disabled=e.get(b),_.readOnly=!s.props.filterable},[()=>({subdued:!e.get(p).includes(e.get(d))&&!s.props.allow_custom_value||e.get(i).length===s.props.max_choices})]),e.bind_value(_,()=>e.get(d),r=>e.set(d,r)),e.event("keydown",_,I),e.event("keyup",_,r=>{s.dispatch("key_up",{key:r.key,input_value:e.get(d)})}),e.event("blur",_,g),e.event("focus",_,S),e.append(w,M),e.pop()}var we=e.from_html('<div class="icon-wrap svelte-1xfsv4t"><!></div>'),ye=e.from_html('<div><!> <div class="wrap svelte-1xfsv4t"><div><div class="secondary-wrap svelte-1xfsv4t"><input role="listbox" aria-controls="dropdown-options" autocomplete="off"/> <!></div></div> <!></div></div>');function xe(w,a){e.push(a,!0);const s=typeof window<"u";e.rest_props(a,["$$slots","$$events","$$legacy"]);const t=a.gradio;let d=e.derived(()=>t.shared.label||"Dropdown"),A,p=e.derived(()=>s&&A===document.activeElement),m=e.derived(()=>t.props.choices.map(l=>l[0])),b=e.derived(()=>t.props.choices.map(l=>l[1])),x=e.derived(()=>t.props.value===void 0||Array.isArray(t.props.value)&&t.props.value.length===0?["",null]:e.get(b).includes(t.props.value)?[e.get(m)[e.get(b).indexOf(t.props.value)],e.get(b).indexOf(t.props.value)]:t.props.allow_custom_value?[t.props.value,null]:["",null]),D=e.derived(()=>e.to_array(e.get(x),2)),u=e.derived(()=>e.get(D)[0]),c=e.derived(()=>e.get(D)[1]),k=e.state(!1),T=e.derived(()=>!t.shared.interactive),i=e.state(e.proxy(t.props.choices.map((l,f)=>f))),g=e.state(null);t.props.value&&(e.set(c,t.props.choices.map(l=>l[1]).indexOf(t.props.value)),e.get(c)===-1?e.set(c,null):e.set(u,t.props.choices[e.get(c)][0]));function C(l){if(e.set(c,parseInt(l.detail.target.dataset.index)),isNaN(e.get(c))){e.set(c,null);return}let[f,v]=t.props.choices[e.get(c)];e.set(u,f),t.props.value=v,t.dispatch("select",{index:e.get(c),value:e.get(b)[e.get(c)],selected:!0}),e.set(p,!1),e.set(g,null),A.blur()}function R(l){e.set(i,t.props.choices.map((f,v)=>v),!0),e.set(p,!0),t.dispatch("focus")}function L(){t.props.allow_custom_value?t.props.value=e.get(u):e.set(u,e.get(m)[e.get(b).indexOf(t.props.value)]),e.set(p,!1),e.set(g,null),e.set(i,t.props.choices.map((l,f)=>f),!0),t.dispatch("blur"),t.dispatch("input")}async function N(l){await ie(),e.set(i,te(t.props.choices,e.get(u)),!0),e.set(g,e.get(i).length>0?e.get(i)[0]:null,!0),(f=>{var v=e.to_array(f,2);e.set(p,v[0]),e.set(g,v[1],!0)})(se(l,e.get(g),e.get(i))),l.key==="Enter"&&(e.get(g)!==null?(e.set(c,e.get(g)),t.props.value=e.get(b)[e.get(g)],e.set(p,!1),A.blur(),e.set(g,null)):e.get(m).includes(e.get(u))?(e.set(c,e.get(m).indexOf(e.get(u))),t.props.value=e.get(b)[e.get(c)],e.set(p,!1),e.set(g,null),A.blur()):t.props.allow_custom_value&&(t.props.value=e.get(u),e.set(c,null),e.set(p,!1),e.set(g,null),A.blur()))}let z=e.state(e.proxy(t.props.value));e.user_effect(()=>{e.get(z)!==t.props.value&&(e.set(z,t.props.value,!0),t.dispatch("change"))});var S=ye();let I;var U=e.child(S);Y(U,{get show_label(){return t.shared.show_label},get info(){return t.props.info},children:(l,f)=>{e.next();var v=e.text();e.template_effect(()=>e.set_text(v,e.get(d))),e.append(l,v)},$$slots:{default:!0}});var M=e.sibling(U,2),P=e.child(M);let q;var G=e.child(P),h=e.child(G);e.remove_input_defaults(h);let j;e.bind_this(h,l=>A=l,()=>A);var J=e.sibling(h,2);{var o=l=>{var f=we(),v=e.child(f);Z(v),e.reset(f),e.append(l,f)};e.if(J,l=>{e.get(T)||l(o)})}e.reset(G),e.reset(P);var _=e.sibling(P,2);{let l=e.derived(()=>e.get(c)===null?[]:[e.get(c)]);ee(_,{get show_options(){return e.get(p)},get choices(){return t.props.choices},get filtered_indices(){return e.get(i)},get disabled(){return e.get(T)},get selected_indices(){return e.get(l)},get active_index(){return e.get(g)},$$events:{change:C,load:()=>e.set(k,!0)}})}e.reset(M),e.reset(S),e.template_effect(l=>{I=e.set_class(S,1,"svelte-1xfsv4t",null,I,{container:t.shared.container}),q=e.set_class(P,1,"wrap-inner svelte-1xfsv4t",null,q,{show_options:e.get(p)}),e.set_attribute(h,"aria-expanded",e.get(p)),e.set_attribute(h,"aria-label",e.get(d)),j=e.set_class(h,1,"border-none svelte-1xfsv4t",null,j,l),h.disabled=e.get(T),h.readOnly=!t.props.filterable},[()=>({subdued:!e.get(m).includes(e.get(u))&&!t.props.allow_custom_value})]),e.bind_value(h,()=>e.get(u),l=>e.set(u,l)),e.event("keydown",h,N),e.event("keyup",h,l=>{t.dispatch("key_up",{key:l.key,input_value:e.get(u)})}),e.event("blur",h,L),e.event("focus",h,R),e.append(w,S),e.pop()}var ke=e.from_html("<!> <!>",1);function Ke(w,a){e.push(a,!0);let s=e.rest_props(a,["$$slots","$$events","$$legacy"]);const t=new le(s);ae(w,{get visible(){return t.shared.visible},get elem_id(){return t.shared.elem_id},get elem_classes(){return t.shared.elem_classes},get padding(){return t.shared.container},allow_overflow:!1,get scale(){return t.shared.scale},get min_width(){return t.shared.min_width},children:(d,A)=>{var p=ke(),m=e.first_child(p);de(m,e.spread_props({get autoscroll(){return t.shared.autoscroll},get i18n(){return t.i18n}},()=>t.shared.loading_status,{on_clear_status:()=>t.dispatch("clear_status",loading_status)}));var b=e.sibling(m,2);{var x=u=>{be(u,{get gradio(){return t}})},D=u=>{xe(u,{get gradio(){return t}})};e.if(b,u=>{t.props.multiselect?u(x):u(D,!1)})}e.append(d,p)},$$slots:{default:!0}}),e.pop()}export{xe as BaseDropdown,ee as BaseDropdownOptions,We as BaseExample,be as BaseMultiselect,Ke as default};
